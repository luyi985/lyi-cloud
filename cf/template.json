{
    "Metadata": {
        "AWS::CloudFormation::Interface": {
            "ParameterGroups": {
                "Label": {"default": "Configuration"},
                "Parameters": [ "ToEmailAddress"]
            }
        }
    },
    "Parameters": {
        "ToEmailAddress": {
            "Type": "String",
            "Description": "Email address you want contact form submittions to go to",
            "Default": "luyi985@gmail.com"
        }
    },
    "Resources": {
        "LambdaRole": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Principal": {"Service": "lambda.amazonaws.com"},
                            "Action": "sts:AssumeRole"
                        }
                    ]
                },
                "ManagedPolicyArns":[
                    "arn:aws:iam::aws:policy/AWSLambdaExecute"
                ],
                "RoleName": { "Fn::Join": ["", [{"Ref": "AWS::Region"}, "lyi_lambda_role"]] }
            }
        },
        "MsgSubscribe": {
            "Type": "AWS::SNS::Topic",
            "Properties": {
                "DisplayName": {"Fn::Join": ["", [{"Ref": "AWS::StackName"}, "Topic"]]},
                "Subscription": [
                    {
                        "Endpoint": { "Ref": "ToEmailAddress"},
                        "Protocol": "email"
                    }
                ]
            }
        }
    },
    "Outputs": {
        "LambdaRoleArn": {
            "Value": {"Fn::GetAtt": ["LambdaRole", "Arn"]}
        }
    }
}